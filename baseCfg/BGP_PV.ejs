
!#start
! sh ip ro con | ex L|variably
! hostname           -> Hostname
! pv_id              -> ID Numerico PV
! pv_magic           -> magic number
! pv_BRAND           -> marchio PV
! pv_name            -> nome PV
! BGP_Local_AS       -> ASN locale
! BGP_Router_id      -> IP riferimento BGP
! BGP_Cato_AS        -> ID numerico ASN
! BGP_Cato_Desc      -> Descrizone peer group
! BGP_Local_SrcIntf  -> Nome interface usata come source
! BGP_Cato_DescVip   -> Descrizone Cato Vip
! BGP_Cato_IpVip     -> IP address VIP Cato
! BGP_Networks       -> TXTAREA lista i textArea
! ToCatoPV           -> TXTAREA prefix list 
!----------------------------------------------
!#stop
<%= hostname %>hostname
<%= pv_id %>ID Numerico PV
<%= pv_magic %>magic number
<%= pv_BRAND %>marchio PV
<%= pv_name %>nome PV
<%= BGP_Local_AS %>ASN locale
<%= BGP_Router_id %>IP riferimento BGP
<%= BGP_Cato_AS %>ID numerico ASN
<%= BGP_Cato_Desc %>Descrizone peer group
<%= BGP_Local_SrcIntf %>Nome interface usata come source
<%= BGP_Cato_DescVip %>Descrizone Cato Vip
<%= BGP_Cato_IpVip %>IP address VIP Cato
<%= BGP_Networks %> TXTAREA lista i textArea
<%= ToCatoPV %> TXTAREA lista i textArea 
!
!
router bgp <%= BGP_Local_AS %>
 bgp router-id <%= BGP_Router_id %>
 bgp log-neighbor-changes
 neighbor CATO peer-group
 neighbor CATO remote-as <%= BGP_Cato_AS %>
 neighbor CATO description <%= BGP_Cato_Desc %>
 neighbor CATO update-source <%= BGP_Local_SrcIntf %>
 neighbor <%= BGP_Cato_IpVip %> peer-group CATO
 neighbor <%= BGP_Cato_IpVip %> shutdown
 neighbor <%= BGP_Cato_IpVip %> description Cato VIP
 !
 address-family ipv4
  no synchronization
  <% BGP_Networks.split("\r\n").forEach(function(iGnOrE,i){ %>
  network <%= iGnOrE %><% }) %>
  neighbor CATO send-community both
  neighbor CATO next-hop-self
  neighbor CATO soft-reconfiguration inbound
  neighbor CATO route-map FromCatoPV in
  neighbor CATO route-map ToCatoPV out
  neighbor <%= BGP_Cato_IpVip %> activate
  no auto-summary
 exit-address-family
!
ip prefix-list FromCatoPV seq 2 deny 0.0.0.0/0 le 32
ip prefix-list FromCatoPV seq 10 permit 0.0.0.0/0
ip prefix-list FromCatoPV seq 15 permit 10.0.0.0/8 le 32
ip prefix-list FromCatoPV seq 16 permit 100.0.0.0/8
ip prefix-list FromCatoPV seq 17 permit 172.21.0.0/16 le 28
ip prefix-list FromCatoPV seq 18 permit 172.25.0.0/24
ip prefix-list FromCatoPV seq 20 permit 0.0.0.0/0 le 32
!
ip prefix-list ToCatoPV seq 5 deny 0.0.0.0/0 le 32<% ToCatoPV.split("\r\n").forEach(function(iGnOrE,i){ %>
ip prefix-list ToCatoPV  permit <%= iGnOrE %><% }) %>


route-map ToCatoPV permit 10
 match ip address prefix-list ToCatoPV
!
route-map FromCatoPV permit 10
 match ip address prefix-list FromCatoPV